<ng-template #context_menu cdkMen>
  <div class="menu" cdkMenu>
    <button [disabled]="isBufferEmpty()" (click)="pasteCell(idMenu)" class="menu-item" cdkMenuItem> <mat-icon>content_paste</mat-icon>Вставить</button>
    <button *ngIf="isCellSetable(idMenu)" (click)="copyCell(idMenu)" class="menu-item" cdkMenuItem> <mat-icon>content_copy</mat-icon>Копировать</button>
    <button *ngIf="isCellSetable(idMenu)" (click)="cutCell(idMenu)" class="menu-item" cdkMenuItem> <mat-icon>content_cut</mat-icon>Вырезать</button>
    <mat-divider *ngIf="isCellSetable(idMenu)">
    </mat-divider>
    <button *ngIf="isCellSetable(idMenu)" (click)="turnCell(idMenu)" class="menu-item" cdkMenuItem> <mat-icon>cached</mat-icon>Повернуть</button>
    <button *ngIf="isCellSetable(idMenu)" (click)="deleteCell(idMenu)" class="menu-item delete" cdkMenuItem> <mat-icon>delete_forever</mat-icon>Удалить</button>

  </div>
</ng-template>

<div #board class="board">
  <mat-grid-list
    #grid
    [cols]="parkingMap.cols"
    gutterSize="0"
    [style.width]="parkingMap.cols * sizeCell + 'px'"
    [style.height]="parkingMap.rows * sizeCell + 'px'"
    [style.margin-top]="marginTop + 'px'"
    [style.margin-left]="marginLeft + 'px'"
    cdkScrollable
  >
    <mat-grid-tile
      *ngFor="let cell of cells; let i = index;"
      cdkScrollable
    >
    <div class="cell-wrapper" [style]="'width: ' + (sizeCell) + 'px; height: ' + (sizeCell) +'px;'">
      <div
        class="cell"
        cdkDropList
        [id]="nameOfIdList + i"
        [cdkDropListData]="cell"
        [cdkDropListConnectedTo]="valueListConnectedTo"
        (cdkDropListDropped)="designerService.drop($event)"
        [class.selected]="i == designerService.indexOver"
        (mouseover)="setIndexOver(i)"
        (mouseout)="designerService.indexOver = -1"
        [class.roadCell] = "isRoad(cell)"
        [cdkContextMenuTriggerFor]="context_menu"
        [cdkContextMenuDisabled]="isRoad(cell)"
        (cdkContextMenuOpened)="idMenu = designerService.indexOver"
        [class.selected]="designerService.selectedCells.includes(i)"
        cdkScrollable
        [style]="'z-index: '+ (designerService.isDragging?1+cells.length+i:1+cells.length-i)  +'; transform: rotate(' + cell.angle+ 'deg);'"
        [class.borderCell] = "isOneBoardCell(cell)"
        
      >
        <div class="cdkDragWrapper" [class.borderCell] = "isMoreBoardCell(cell)" [style]="'width: ' + (cell.type.cols*sizeCell) + 'px; height: ' + (cell.type.rows*sizeCell) +'px;'">
          <div  [cdkDragDisabled]="isRoad(cell)"  cdkDrag (cdkDragMoved)="designerService.move($event)">
            <img cdkDragRootElement *ngIf="cell.type.src" [src]="cell.type.src"  [width]="cell.type.cols*sizeCell" [height]="cell.type.rows*sizeCell"/>
            <!-- <span *ngIf="!cell.type.src">OPS</span> -->
            <div *cdkDragPlaceholder></div>
          </div>
        </div>
      </div>
    </div>
    </mat-grid-tile>
  </mat-grid-list>
</div>
<!-- [style]="'width: ' + (cell.type.cols*sizeCell) + 'px; height: ' + (cell.type.rows*sizeCell) +'px;'" -->
